<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>appearance.html - マカロン選択</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap");
    html,body{height:100%;margin:0}
    body{
      font-family:"Noto Sans JP",sans-serif;
      background-image:url("/assets/stage1/space_background.png"); /* ← public を外す */
      background-size:cover;background-position:center;background-attachment:fixed;
      color:#fff;display:flex;align-items:center;justify-content:center;text-align:center;padding:24px
    }
    .card{
      backdrop-filter: blur(6px);
      background: rgba(255,255,255,.14);
      border: 1px solid rgba(255,255,255,.3);
      border-radius: 18px;
      padding: 22px;
      width:min(92vw,760px);
      box-shadow:0 10px 40px rgba(0,0,0,.35);
    }
    h1{margin:0 0 6px;font-size:clamp(20px,4.6vw,28px)}
    p{margin:0 0 18px;line-height:1.7}
    .grid{display:grid;grid-template-columns:repeat(4,minmax(110px,1fr));gap:12px}
    .macaron{
      background:rgba(255,255,255,.18);border:1px solid rgba(255,255,255,.4);
      border-radius:16px;padding:12px 10px;cursor:pointer;transition:.15s;
    }
    .macaron:hover{transform:translateY(-4px) scale(1.03);background:rgba(255,255,255,.24)}
    .macaron img{width:74px;height:74px;object-fit:contain;display:block;margin:0 auto 6px}
    .label{font-weight:700;font-size:14px}
    .trait{opacity:.9;font-size:12px}
    @media (max-width:640px){.grid{grid-template-columns:repeat(2,1fr)}}
  </style>
</head>
<body>
  <div class="card">
    <h1>これから、もっとお話しよう。</h1>
    <p>マカロンをクリックしてね。選んだ色の性格で進化して、会話に行くよ。</p>

    <div class="grid" id="macaronGrid">
      <!-- 実ファイルに合わせて /assets/stage1/*.png を使用 -->
      <div class="macaron" data-color="pink"  data-trait="passion">
        <img src="/assets/stage1/macaron_pink.png"  alt="ピンク">
        <div class="label">pink</div><div class="trait">情熱</div>
      </div>
      <div class="macaron" data-color="blue"  data-trait="calm">
        <img src="/assets/stage1/macaron_blue.png"  alt="青">
        <div class="label">blue</div><div class="trait">静寂</div>
      </div>
      <div class="macaron" data-color="green" data-trait="energy">
        <img src="/assets/stage1/macaron_green.png" alt="緑">
        <div class="label">green</div><div class="trait">元気</div>
      </div>
      <div class="macaron" data-color="purple" data-trait="creative">
        <img src="/assets/stage1/macaron_purple.png" alt="紫">
        <div class="label">purple</div><div class="trait">創造</div>
      </div>
    </div>
  </div>

  <script>
    // あなたの実ファイルに合わせたキャラ画像（stage2 が無いので置き換え）
    // green は green_open.png、それ以外は miwacchi_open.png を使う
    const EVOLVED = {
      pink:   "/assets/stage1/miwacchi_open.png",
      blue:   "/assets/stage1/miwacchi_open.png",
      green:  "/assets/stage1/green_open.png",
      purple: "/assets/stage1/miwacchi_open.png"
    };
    const TYPE_BY = { pink:"passion", blue:"calm", green:"energy", purple:"creative" };

    document.getElementById("macaronGrid").addEventListener("click",(e)=>{
      const card = e.target.closest(".macaron"); if(!card) return;
      const color = card.dataset.color;
      const trait = card.dataset.trait;

      // 会話ページで使う情報を保存
      localStorage.setItem("whoai_macaron", color);
      localStorage.setItem("whoai_trait", trait);
      localStorage.setItem("whoai_type", TYPE_BY[color]);     // 互換
      localStorage.setItem("characterImage", EVOLVED[color]);  // 進化後の見た目

      // 会話ページへ
      window.location.href = "conversation.html";
    });
  </script>
</body>
</html>
