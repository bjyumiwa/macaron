<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>rebirth - 復活の儀式</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    html,body{height:100%;margin:0}
    body{
      font-family:"Noto Sans JP",sans-serif;color:#fff;background:#0b0f19;
      display:flex;flex-direction:column;align-items:center;justify-content:center
    }
    .row{display:flex;gap:16px;flex-wrap:wrap}
    button{
      border:none;border-radius:14px;padding:14px 18px;cursor:pointer;
      background:#ffd1ec;color:#111;font-weight:800;min-width:220px
    }
    .sub{opacity:.8;margin-top:10px}
  </style>
</head>
<body>
  <h2>復活の儀式</h2>
  <div class="sub">どちらかを選んでください</div>
  <div class="row" style="margin-top:16px">
    <button id="keepMemory">記録（メモリ）を保つ（容姿は変化）</button>
    <button id="keepAppearance">容姿を保つ（記録リセット）</button>
  </div>

<script>
const ROOT = (location.pathname.startsWith('/macaron/')) ? '/macaron' : '';
const goTalk = ()=> location.href = `${ROOT}/whoai_talk.html`;

document.getElementById('keepMemory').addEventListener('click', ()=>{
  // 記録（会話ログ/ターン）維持 → 外見だけ変える（=カラー選び直しに遷移）
  // ここでは turn は維持、stage は tane に戻して「見た目だけ変わる」分岐も可
  // 今回は仕様どおり：記録維持 ＋ 見た目再選択へ（= マカロンへ）
  localStorage.setItem('whoai_stage','tane');
  // turn は維持（whoai_talkで10に達すればまた進化へ）
  location.href = `${ROOT}/macaron.html`;
});

document.getElementById('keepAppearance').addEventListener('click', ()=>{
  // 容姿維持（色・進化状態は保持）、記録をリセット
  localStorage.setItem('whoai_turn','0');
  localStorage.setItem('whoai_stage','evolved');
  // 再び justEvolved は false のままでOK（通常会話へ）
  goTalk();
});
</script>
</body>
</html>
